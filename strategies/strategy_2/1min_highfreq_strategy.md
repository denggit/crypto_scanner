
# 📈 高频短线策略文档（1分钟周期）

## 策略名称
**1分钟K线突破确认策略（ATR过滤 + 可选放量）**

---

## 策略概述

该策略针对1分钟级别的高频合约交易，基于K线连续突破信号来判断短期趋势启动。  
通过连续性价格突破确认 + ATR波动过滤 + 可选放量条件，减少震荡假信号。  
策略支持双向交易（多空皆可），配合移动止损实现全自动化执行。

---

## 多空开平仓逻辑

### 🟢 做多逻辑（LONG）

**开多条件 (LONG_OPEN):**
1. 无持仓 (`mock_position == 0`)
2. 连续 n 根K线（默认 n=2）满足：  
   - 当前K线 `close` > 前一根K线 `(high + low + close) / 3`
   - 且前一根K线 `close` > 再前一根K线 `(high + low + close) / 3`
3. ATR(14) > ATR均值 × 0.8 （波动率足够高）  
4. 可选条件：当前成交量 > 前20根K线平均成交量 × 1.2（放量确认）  
5. 满足以上条件 → **开多仓**  
   - 记录入场价 `entry_price = close`
   - 初始化最高价 `highest_price = close`  
   - 设置 `mock_position = 1`

**平多条件 (LONG_CLOSE):**
1. **价格下破移动止损价：**  
   - 移动止损价 = 最高价 × (1 - trailing_stop_pct)  
   - 若当前价格 ≤ 移动止损价 → 平多仓
2. **连续2根K线下破：**  
   - 连续2根K线 `close` < 前一根K线 `(high + low + close) / 3`
   - 则平多仓
3. 平仓时计算收益 `(exit_price - entry_price) / entry_price`

---

### 🔴 做空逻辑（SHORT）

**开空条件 (SHORT_OPEN):**
1. 无持仓 (`mock_position == 0`)
2. 连续 n 根K线（默认 n=2）满足：  
   - 当前K线 `close` < 前一根K线 `(high + low + close) / 3`
   - 且前一根K线 `close` < 再前一根K线 `(high + low + close) / 3`
3. ATR(14) > ATR均值 × 0.8  
4. 可选条件：成交量 > 前20根平均成交量 × 1.2  
5. 满足以上条件 → **开空仓**  
   - 记录入场价 `entry_price = close`
   - 初始化最低价 `lowest_price = close`
   - 设置 `mock_position = -1`

**平空条件 (SHORT_CLOSE):**
1. **价格上破移动止损价：**  
   - 移动止损价 = 最低价 × (1 + trailing_stop_pct)  
   - 若当前价格 ≥ 止损价 → 平空仓
2. **连续2根K线上破：**  
   - 连续2根K线 `close` > 前一根K线 `(high + low + close) / 3`
   - 则平空仓
3. 平仓时计算收益 `(entry_price - exit_price) / entry_price`

---

## 移动止损机制（Trailing Stop）

| 仓位方向 | 止损计算方式 | 更新逻辑 |
|-----------|----------------|------------|
| 多仓 | 止损价 = 最高价 × (1 - trailing_stop_pct) | 每当价格创新高时更新最高价 |
| 空仓 | 止损价 = 最低价 × (1 + trailing_stop_pct) | 每当价格创新低时更新最低价 |

推荐参数：`trailing_stop_pct = 0.6% ~ 1.0%`

---

## 参数建议

| 参数 | 默认值 | 建议范围 | 说明 |
|------|----------|-----------|--------|
| n | 2 | 2~3 | 连续K线数量 |
| ATR周期 | 14 | 10~20 | 波动过滤 |
| ATR阈值 | 0.8 | 0.7~1.0 | 用于确认波动强度 |
| trailing_stop_pct | 0.8% | 0.5%~1.2% | 移动止损百分比 |
| volume_factor | 1.2 | 1.0~1.5 | 放量过滤比例 |

---

## 策略特点

✅ 高频、无滞后指标  
✅ 可自动切换多空方向  
✅ 移动止损保护利润  
✅ 结合波动确认，减少震荡假信号  
✅ 可与OKX接口实时执行

---

## 可扩展优化方向

- 使用 **短周期EMA** 辅助确认趋势强度（如 EMA(5) > EMA(12)）  
- 引入 **RSI(7)** 动量确认（多头RSI > 55，空头RSI < 45）  
- 增加 **波动收缩识别机制**：在突破前波动率显著下降时提前预警  
- 使用 **多币种轮询执行**，根据ATR/波动动态调整仓位权重

---

## 执行框架建议

1. 实时拉取1m K线数据（保持最新300根）  
2. 每根K线闭合时更新信号  
3. 满足条件则通过OKX API执行下单  
4. 实时更新持仓与移动止损价格  
5. 当价格触发止损或信号反转时立即平仓

---

**作者备注：**  
该策略适合 BTC/ETH 等高流动性币种的高频合约交易，  
通过严控止损和波动过滤，在短期波动中捕捉微趋势。

